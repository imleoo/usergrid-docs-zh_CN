

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Message Queue Service &mdash; Usergrid v1.0 documentation</title>
    <link rel="stylesheet" href="_static/styles.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="Usergrid v1.0 documentation" href="index.html" />
    <link rel="next" title="Entity Reference" href="entities/entities.html" />
    <link rel="prev" title="Data Model" href="data_model.html" /> 
  </head>
  <body>
      <div class="header"><img class="rightlogo" src="_static/usergrid_400.png" alt="Logo"/><h1 class="heading"><a href="index.html">
          <span>Usergrid v1.0 documentation</span></a></h1>
        <h2 class="heading"><span>Message Queue Service</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="data_model.html">Data Model</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="entities/entities.html">Entity Reference</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="message-queue-service">
<h1>Message Queue Service<a class="headerlink" href="#message-queue-service" title="Permalink to this headline">¶</a></h1>
<p>The message queue service is designed to provide the ability to distribute
messages to applications in a way that&#8217;s both very easy to use as well as
highly scalable and with enough options to enable a variety of use cases. The
service is intended to have the flexibility to power server to client
notifications, social inboxes, content feeds, commenting services, as well as
traditional distributed message queue operations.</p>
<div class="section" id="basic-concepts">
<h2>Basic Concepts<a class="headerlink" href="#basic-concepts" title="Permalink to this headline">¶</a></h2>
<div class="section" id="messages">
<h3>Messages<a class="headerlink" href="#messages" title="Permalink to this headline">¶</a></h3>
<p>A Message is a JSON object. It contains a UUID and a timestamp, everything
else is application defined. Once create, messages are persistent and cannot
be modified or deleted.</p>
</div>
<div class="section" id="queues">
<h3>Queues<a class="headerlink" href="#queues" title="Permalink to this headline">¶</a></h3>
<p>A Queue is a timestamp-ordered set of messages. Queues can be queried from any
point in time. Typically, though, you&#8217;ll retrieve new messages since the last
time you checked. Queues are used for both one-to-one and one-to-many delivery
of messages, and queues can subscribe to other queues. Queues are also full
JSON objects and can have any arbitrary properties associated with them. These
properties can be used as criteria in message delivery. For example, a message
can be delivered to subscribers where &#8220;location contains &#8216;new york&#8217;&#8221;.</p>
</div>
<div class="section" id="session">
<h3>Session<a class="headerlink" href="#session" title="Permalink to this headline">¶</a></h3>
<p>A Session represents persistent client state for interactions with the queue
service. Sessions are completely optional and are provided for convenience. If
no Session ID is provided during an MQ API call, a new one is generated and
returned. Sessions do not time out, an application will typically cache the
same session for it&#8217;s lifetime.</p>
</div>
</div>
<div class="section" id="basic-operations">
<h2>Basic Operations<a class="headerlink" href="#basic-operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-a-message">
<h3>Creating a message<a class="headerlink" href="#creating-a-message" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="method-post-http-apiusergridcom-my-app-queues-foo-bar">
<tt class="descclassname deschttpmethod">POST </tt><tt class="descname deschttpurl"><span class="deschttppath">/my-app/queues/foo/bar</span></tt><a class="headerlink" href="#method-post-http-apiusergridcom-my-app-queues-foo-bar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><em>Request Body</em></p>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;test&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Response Body</em></p>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">,</span>
    <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;/foo/bar/&quot;</span><span class="p">,</span>
    <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;1c184f38-9134-3400-b802-81315d9e7388&quot;</span><span class="p">,</span>
    <span class="s2">&quot;messages&quot;</span> <span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span> <span class="o">:</span> <span class="mi">1314034739489</span><span class="p">,</span>
            <span class="s2">&quot;uuid&quot;</span> <span class="o">:</span> <span class="s2">&quot;9e33d9e5-cce5-11e0-9af9-9227e40e3559&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;last&quot;</span> <span class="o">:</span> <span class="s2">&quot;9e33d9e5-cce5-11e0-9af9-9227e40e3559&quot;</span><span class="p">,</span>
    <span class="s2">&quot;session&quot;</span> <span class="o">:</span> <span class="s2">&quot;9f824f7f-cce1-11e0-b0a3-9227e40e3559&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="retrieving-a-message">
<h3>Retrieving a message<a class="headerlink" href="#retrieving-a-message" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="method-get-http-apiusergridcom-my-app-queues-foo-bar">
<tt class="descclassname deschttpmethod">GET </tt><tt class="descname deschttpurl"><span class="deschttppath">/my-app/queues/foo/bar</span></tt><a class="headerlink" href="#method-get-http-apiusergridcom-my-app-queues-foo-bar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><em>Response Body</em></p>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">,</span>
    <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;/foo/bar/&quot;</span><span class="p">,</span>
    <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;1c184f38-9134-3400-b802-81315d9e7388&quot;</span><span class="p">,</span>
    <span class="s2">&quot;messages&quot;</span> <span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span> <span class="o">:</span> <span class="mi">1314034739489</span><span class="p">,</span>
            <span class="s2">&quot;uuid&quot;</span> <span class="o">:</span> <span class="s2">&quot;9e33d9e5-cce5-11e0-9af9-9227e40e3559&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;last&quot;</span> <span class="o">:</span> <span class="s2">&quot;9e33d9e5-cce5-11e0-9af9-9227e40e3559&quot;</span><span class="p">,</span>
    <span class="s2">&quot;session&quot;</span> <span class="o">:</span> <span class="s2">&quot;9e35aea7-cce5-11e0-9af9-9227e40e3559&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="subscriptions">
<h2>Subscriptions<a class="headerlink" href="#subscriptions" title="Permalink to this headline">¶</a></h2>
<p>Historically, message queue systems have made a distinction between queues and
topics, where a queue was meant for one-to-one distribution of messages from a
producer and a consumer and a topic was for one-to-many distribution of
messages from a publisher to many subscribers. We eliminate that distinction
and provide two different options for one-to-many distribution of messages:</p>
<blockquote>
<div><ul class="simple">
<li>Multiple clients can read messages from the same queue</li>
<li>Queues can subscribe to other queues</li>
</ul>
</div></blockquote>
<div class="section" id="multiple-clients-reading-from-a-single-queue">
<h3>Multiple Clients Reading from a Single Queue<a class="headerlink" href="#multiple-clients-reading-from-a-single-queue" title="Permalink to this headline">¶</a></h3>
<p>When reading from a queue, you can specify the position to read from as either
&#8220;last&#8221;, meaning to read from the last point that anyone read from the queue,
or &#8220;session&#8221;, meaning the last point that the client read from the queue. In a
situation where you have multiple client &#8220;workers&#8221; that are consuming events
from a queue, you would use the &#8220;position=last&#8221; option when retrieving
messages. If you were broadcasting messages where every client should receive
every message, you would save your session ID and use it every time you
connected, specifying the &#8220;position=session&#8221; (this is the default when a
session ID is provided).</p>
</div>
<div class="section" id="queues-subscribing-to-other-queues">
<h3>Queues Subscribing To Other Queues<a class="headerlink" href="#queues-subscribing-to-other-queues" title="Permalink to this headline">¶</a></h3>
<p>A queue can have any number of other queues subscribe to it. When a message is
posted to the first queue, a copy of it is placed into every subscribing
queue. This makes it possible to create queues that aggregate messages from a
number of source queues. This allows you to create things like inboxes or
social functionality such as &#8220;following&#8221; where a user would have a feed
containing all the activities of the users they follow. The user&#8217;s feed would
be a queue that subscribed to all of the queues of the users they followed.</p>
<div class="section" id="gateway-queues">
<h4>Gateway Queues<a class="headerlink" href="#gateway-queues" title="Permalink to this headline">¶</a></h4>
<p>Subscriptions are also useful for distributing messages to special gateway
queues for relaying to other message-oriented services such as Twitter or
Facebook, or the Apple Push Notification Service and Android Cloud to Device
Messaging. For example, to relay messages to an iOS device, you would add the
following queue as a subscriber to your user&#8217;s inbox queue:</p>
<blockquote>
<div>/apns/<em>&lt;ios_device_id&gt;</em></div></blockquote>
<p>For Android applications, the subscriber would be:</p>
<blockquote>
<div>/c2dm/<em>&lt;android_registration_id&gt;</em></div></blockquote>
<p>For relaying to Twitter, the subscriber would be:</p>
<blockquote>
<div>/twitter/<em>&lt;twitter_user_id&gt;</em></div></blockquote>
<p>Gateway queues are described in more detail in the appendix and often require
additional configuration to work correctly.</p>
</div>
</div>
</div>
<div class="section" id="api-endpoints">
<h2>API Endpoints<a class="headerlink" href="#api-endpoints" title="Permalink to this headline">¶</a></h2>
<div class="section" id="post-messages">
<h3>Post Messages<a class="headerlink" href="#post-messages" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="method-post-app_id-queues-path-to-queue-cascade-true-session-session_id">
<tt class="descclassname deschttpmethod">POST </tt><tt class="descname deschttpurl"><span class="deschttppath">/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">app_id</span>}</em>/queues/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">path/to/queue</span>}</em></span><span class="deschttpquery">?<em class="deschttpqueryparam">cascade=true</em>&amp;<em class="deschttpqueryparam">session=&lt;session_id&gt;</em></span></tt><a class="headerlink" href="#method-post-app_id-queues-path-to-queue-cascade-true-session-session_id" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Path arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>app_id</strong> &#8211; application UUID or application name</li>
<li><strong>path/to/queue</strong> &#8211; a queue path</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Opt. params:</th><td class="field-body"><ul class="first simple">
<li><strong>cascade</strong> &#8211; (false,1..n,all, default=1) what level of subscribers to distribute message to</li>
<li><strong>session</strong> &#8211; a session id</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Request Body:</th><td class="field-body"><p class="first last">Either a single set of message properties:</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;foo&quot;</span> <span class="o">:</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span> <span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;b&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="o">:</span> <span class="mi">2</span> <span class="p">},</span> <span class="nx">timestamp</span> <span class="o">:</span> <span class="mi">1314034739489</span> <span class="p">}</span>
</pre></div>
</div>
<p>Or an array of message properties in order to post multiple
messages:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;foo&quot;</span> <span class="o">:</span> <span class="s2">&quot;bar&quot;</span> <span class="p">},</span> <span class="p">{</span> <span class="s2">&quot;foo&quot;</span> <span class="o">:</span> <span class="s2">&quot;baz&quot;</span><span class="p">}</span> <span class="p">]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Response Body:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">,</span>
  <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;path/to/queue&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;queue Id&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messages&quot;</span> <span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
          <span class="s2">&quot;foo&quot;</span> <span class="o">:</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span>
          <span class="s2">&quot;a&quot;</span> <span class="o">:</span> <span class="p">{</span>
              <span class="s2">&quot;b&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
              <span class="s2">&quot;c&quot;</span> <span class="o">:</span> <span class="mi">2</span>
          <span class="p">},</span>
          <span class="s2">&quot;timestamp&quot;</span> <span class="o">:</span> <span class="o">&lt;</span><span class="nx">timestamp</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="s2">&quot;uuid&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;new_message_uuid&gt;&quot;</span>
      <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;last&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;uuid_of_last_message&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;session&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;session_id&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Post a message to the specified queue path. Queues are specified by
hierachical paths delimited by slashes. Queues do not need to be defined
before being used, simply posting to a queue path creates the queue if it
doesn&#8217;t already exist.</p>
<p>Message contents are specified in JSON format. Any JSON object can be
stored in in message, not just name/value pairs.</p>
<p>Messages by default cascade to subscribers. This is the equivalent of
specifying cascade=1. If you want to prevent this, specify cascade=false.
To have messages cascade to subscribers of subscribers, specify cascade=2.
To have messages cascade down the complete subscriber tree, specify
cascade=all.</p>
<p>It is optional for the calling application to provide a timestamp for new
messages as one of the values in the message properties sent in the request
body. If a timestamp is not provided, the system will generate one. It is
recommended that, if possible, to let the system assign timestamp values
rather than creating them in your application as to ensure that there are
no issues with differences between clock accuracy on the local device or
computer and the server.</p>
</dd></dl>

</div>
<div class="section" id="get-messages">
<h3>Get Messages<a class="headerlink" href="#get-messages" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="method-get-app_id-queues-path-to-queue-session-last-time-prev-next-limit-pos-update-atomic-">
<tt class="descclassname deschttpmethod">GET </tt><tt class="descname deschttpurl"><span class="deschttppath">/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">app_id</span>}</em>/queues/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">path/to/queue</span>}</em></span><span class="deschttpquery">?<em class="deschttpqueryparam">session=</em>&amp;<em class="deschttpqueryparam">last=</em>&amp;<em class="deschttpqueryparam">time=</em>&amp;<em class="deschttpqueryparam">prev=</em>&amp;<em class="deschttpqueryparam">next=</em>&amp;<em class="deschttpqueryparam">limit=</em>&amp;<em class="deschttpqueryparam">pos=</em>&amp;<em class="deschttpqueryparam">update=</em>&amp;<em class="deschttpqueryparam">atomic=</em></span></tt><a class="headerlink" href="#method-get-app_id-queues-path-to-queue-session-last-time-prev-next-limit-pos-update-atomic-" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Path arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>app_id</strong> &#8211; application UUID or application name</li>
<li><strong>path/to/queue</strong> &#8211; a queue path</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Opt. params:</th><td class="field-body"><ul class="first simple">
<li><strong>session</strong> &#8211; a session id</li>
<li><strong>last</strong> &#8211; the last message id retrieved from the queue, return messages after this one</li>
<li><strong>time</strong> &#8211; the timestamp to start returning messages from</li>
<li><strong>prev</strong> &#8211; the number of previously retrieved messages to return</li>
<li><strong>next</strong> &#8211; the number of new messages to return</li>
<li><strong>limit</strong> &#8211; the total number of messages to return</li>
<li><strong>pos</strong> &#8211; (start,end,last,session default=session) where in the queue to start returning messages from</li>
<li><strong>update</strong> &#8211; (true,false default=true) whether to update the position after retrieving the messages</li>
<li><strong>atomic</strong> &#8211; (true,false default=false) whether to ensure that requests are executed sequentially across clients</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Response Body:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">,</span>
  <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;path/to/queue&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;queue_id&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messages&quot;</span> <span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
          <span class="s2">&quot;foo&quot;</span> <span class="o">:</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span>
          <span class="s2">&quot;a&quot;</span> <span class="o">:</span> <span class="p">{</span>
              <span class="s2">&quot;b&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
              <span class="s2">&quot;c&quot;</span> <span class="o">:</span> <span class="mi">2</span>
          <span class="p">},</span>
          <span class="s2">&quot;timestamp&quot;</span> <span class="o">:</span> <span class="o">&lt;</span><span class="nx">timestamp</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="s2">&quot;uuid&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;message_uuid&gt;&quot;</span>
      <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;last&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;uuid_of_last_message&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;session&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;session_id&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Get messages from the specified queue path. The default operation is to
return the next message after the last message that was retrieved.
Additional messages can be specified by setting the next parameter which
will return the specified number of new operations from the last message
retrieved.</p>
<p>The following example request that will return the next message in a queue
every time it&#8217;s invoked:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">GET</span> <span class="o">/</span><span class="nx">test</span><span class="o">-</span><span class="nx">app</span><span class="o">/</span><span class="nx">queues</span><span class="o">/</span><span class="nx">my</span><span class="o">-</span><span class="nx">queue</span>
</pre></div>
</div>
<p>Because no client session is maintained, every client app that makes that
request will receive the next message with no two clients receiving the
same message.</p>
<p>This is an example of a request that will return the next message in a
queue for a specific client session. Different clients with different
session ids will only see the messages they haven&#8217;t seen before:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">GET</span> <span class="o">/</span><span class="nx">test</span><span class="o">-</span><span class="nx">app</span><span class="o">/</span><span class="nx">queues</span><span class="o">/</span><span class="nx">my</span><span class="o">-</span><span class="nx">queue</span><span class="o">?</span><span class="nx">session</span><span class="o">=</span><span class="mi">9</span><span class="nx">e35aea7</span><span class="o">-</span><span class="nx">cce5</span><span class="o">-</span><span class="mi">11</span><span class="nx">e0</span><span class="o">-</span><span class="mi">9</span><span class="nx">af9</span><span class="o">-</span><span class="mi">9227</span><span class="nx">e40e3559</span>
</pre></div>
</div>
<p>This example request will return a feed of the 10 most recent messages,
suitable for a content feed or a social inbox:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">GET</span> <span class="o">/</span><span class="nx">test</span><span class="o">-</span><span class="nx">app</span><span class="o">/</span><span class="nx">queues</span><span class="o">/</span><span class="nx">my</span><span class="o">-</span><span class="nx">queue</span><span class="o">?</span><span class="nx">pos</span><span class="o">=</span><span class="nx">end</span><span class="o">&amp;</span><span class="nx">limit</span><span class="o">=</span><span class="mi">10</span>
</pre></div>
</div>
<p>This example request will return up to 10 new messages and 3 old messages,
perhaps what might be show when logging in to an instant messaging client
similar to the way Skype does:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">GET</span> <span class="o">/</span><span class="nx">test</span><span class="o">-</span><span class="nx">app</span><span class="o">/</span><span class="nx">queues</span><span class="o">/</span><span class="nx">my</span><span class="o">-</span><span class="nx">queue</span><span class="o">?</span><span class="nx">session</span><span class="o">=</span><span class="mi">9</span><span class="nx">e35aea7</span><span class="o">-</span><span class="nx">cce5</span><span class="o">-</span><span class="mi">11</span><span class="nx">e0</span><span class="o">-</span><span class="mi">9</span><span class="nx">af9</span><span class="o">-</span><span class="mi">9227</span><span class="nx">e40e3559</span><span class="o">&amp;</span><span class="nx">prev</span><span class="o">=</span><span class="mi">5</span><span class="o">&amp;</span><span class="nx">next</span><span class="o">=</span><span class="mi">10</span>
</pre></div>
</div>
<p>Notice the session ID is provided, meaning that the position in the queue
will be specific to the individual user.</p>
</dd></dl>

</div>
<div class="section" id="add-subscriber">
<h3>Add Subscriber<a class="headerlink" href="#add-subscriber" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="method-put-app_id-queues-path-to-publisher_queue-subscribers-path-to-subscriber_queue-">
<tt class="descclassname deschttpmethod">PUT </tt><tt class="descname deschttpurl"><span class="deschttppath">/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">app_id</span>}</em>/queues/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">path/to/publisher_queue</span>}</em>/subscribers/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">path/to/subscriber_queue</span>}</em></span></tt><a class="headerlink" href="#method-put-app_id-queues-path-to-publisher_queue-subscribers-path-to-subscriber_queue-" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Path arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>app_id</strong> &#8211; application UUID or application name</li>
<li><strong>path/to/publisher_queue</strong> &#8211; a queue path</li>
<li><strong>path/to/subscriber_queue</strong> &#8211; a queue path</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Response Body:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">,</span>
  <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;path/to/publisher_queue&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;publisher_queue_id&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;subscribers&quot;</span> <span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
          <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;path/to/subscriber_queue&quot;</span><span class="p">,</span>
          <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;subscriber_queue_id&quot;</span><span class="p">,</span>
      <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;last&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;uuid_of_last_message&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;session&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;session_id&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Add a single subscriber to the specified queue.</p>
</dd></dl>

</div>
<div class="section" id="add-one-or-more-subscribers">
<h3>Add One Or More Subscribers<a class="headerlink" href="#add-one-or-more-subscribers" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="method-put-app_id-queues-path-to-publisher_queue-subscribers">
<tt class="descclassname deschttpmethod">PUT </tt><tt class="descname deschttpurl"><span class="deschttppath">/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">app_id</span>}</em>/queues/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">path/to/publisher_queue</span>}</em>/subscribers</span></tt><a class="headerlink" href="#method-put-app_id-queues-path-to-publisher_queue-subscribers" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Path arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>app_id</strong> &#8211; application UUID or application name</li>
<li><strong>path/to/publisher_queue</strong> &#8211; a queue path</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Request Body:</th><td class="field-body"><p class="first last">Either a single subscriber:</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;subscriber&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;path/to/subscriber_queue&gt;&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>Or an array of message properties in order to post multiple
messages:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;subscribers&quot;</span> <span class="o">:</span> <span class="p">[</span><span class="s2">&quot;&lt;path/to/subscriber_queue&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;path/to/subscriber_queue&gt;&quot;</span><span class="p">]</span> <span class="p">}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Response Body:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">,</span>
  <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;path/to/publisher_queue&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;publisher_queue_id&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;subscribers&quot;</span> <span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
          <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;path/to/subscriber_queue&quot;</span><span class="p">,</span>
          <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;subscriber_queue_id&quot;</span><span class="p">,</span>
      <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;last&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;uuid_of_last_message&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;session&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;session_id&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Add one or more subscribers to the specified queue.</p>
</dd></dl>

</div>
<div class="section" id="delete-subscriber">
<h3>Delete Subscriber<a class="headerlink" href="#delete-subscriber" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="method-delete-app_id-queues-path-to-publisher_queue-subscribers-path-to-subscriber_queue-">
<tt class="descclassname deschttpmethod">DELETE </tt><tt class="descname deschttpurl"><span class="deschttppath">/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">app_id</span>}</em>/queues/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">path/to/publisher_queue</span>}</em>/subscribers/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">path/to/subscriber_queue</span>}</em></span></tt><a class="headerlink" href="#method-delete-app_id-queues-path-to-publisher_queue-subscribers-path-to-subscriber_queue-" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Path arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>app_id</strong> &#8211; application UUID or application name</li>
<li><strong>path/to/publisher_queue</strong> &#8211; a queue path</li>
<li><strong>path/to/subscriber_queue</strong> &#8211; a queue path</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Response Body:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">,</span>
  <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;path/to/publisher_queue&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;publisher_queue_id&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;subscribers&quot;</span> <span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
          <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;path/to/subscriber_queue&quot;</span><span class="p">,</span>
          <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;subscriber_queue_id&quot;</span><span class="p">,</span>
      <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;last&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;uuid_of_last_message&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;session&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;session_id&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Remove a single subscriber to the specified queue.</p>
</dd></dl>

</div>
<div class="section" id="delete-one-or-more-subscribers">
<h3>Delete One Or More Subscribers<a class="headerlink" href="#delete-one-or-more-subscribers" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="method-delete-app_id-queues-path-to-publisher_queue-subscribers">
<tt class="descclassname deschttpmethod">DELETE </tt><tt class="descname deschttpurl"><span class="deschttppath">/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">app_id</span>}</em>/queues/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">path/to/publisher_queue</span>}</em>/subscribers</span></tt><a class="headerlink" href="#method-delete-app_id-queues-path-to-publisher_queue-subscribers" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Path arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>app_id</strong> &#8211; application UUID or application name</li>
<li><strong>path/to/publisher_queue</strong> &#8211; a queue path</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Request Body:</th><td class="field-body"><p class="first last">Either a single subscriber:</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;subscriber&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;path/to/subscriber_queue&gt;&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>Or an array of message properties in order to post multiple
messages:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;subscribers&quot;</span> <span class="o">:</span> <span class="p">[</span><span class="s2">&quot;&lt;path/to/subscriber_queue&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;path/to/subscriber_queue&gt;&quot;</span><span class="p">]</span> <span class="p">}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Response Body:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">,</span>
  <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;path/to/publisher_queue&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;publisher_queue_id&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;subscribers&quot;</span> <span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
          <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;path/to/subscriber_queue&quot;</span><span class="p">,</span>
          <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;subscriber_queue_id&quot;</span><span class="p">,</span>
      <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;last&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;uuid_of_last_message&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;session&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;session_id&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Remove one or more subscribers from the specified queue.</p>
</dd></dl>

</div>
<div class="section" id="get-subscribers">
<h3>Get Subscribers<a class="headerlink" href="#get-subscribers" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="method-get-app_id-queues-path-to-publisher_queue-subscribers-cascade-path-limit-">
<tt class="descclassname deschttpmethod">GET </tt><tt class="descname deschttpurl"><span class="deschttppath">/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">app_id</span>}</em>/queues/<em class="deschttppatharg">{<span class="deschttppatharg deschttppatharg">path/to/publisher_queue</span>}</em>/subscribers</span><span class="deschttpquery">?<em class="deschttpqueryparam">cascade=</em>&amp;<em class="deschttpqueryparam">path=</em>&amp;<em class="deschttpqueryparam">limit=</em></span></tt><a class="headerlink" href="#method-get-app_id-queues-path-to-publisher_queue-subscribers-cascade-path-limit-" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Path arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>app_id</strong> &#8211; application UUID or application name</li>
<li><strong>path/to/publisher_queue</strong> &#8211; a queue path</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Opt. params:</th><td class="field-body"><ul class="first simple">
<li><strong>cascade</strong> &#8211; (1..n,all, default=1) what level of subscribers to return</li>
<li><strong>path</strong> &#8211; the path of the first subscriber queue to return</li>
<li><strong>limit</strong> &#8211; the total number of messages to return</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Response Body:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">,</span>
  <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;path/to/publisher_queue&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;publisher_queue_id&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;subscribers&quot;</span> <span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
          <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;path/to/subscriber_queue&quot;</span><span class="p">,</span>
          <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;subscriber_queue_id&quot;</span><span class="p">,</span>
      <span class="p">},</span>
      <span class="p">{</span>
          <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;path/to/subscriber_queue&quot;</span><span class="p">,</span>
          <span class="s2">&quot;queue&quot;</span> <span class="o">:</span> <span class="s2">&quot;subscriber_queue_id&quot;</span><span class="p">,</span>
      <span class="p">},</span>
      <span class="p">...</span>
  <span class="p">],</span>
  <span class="s2">&quot;last&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;uuid_of_last_message&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;session&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;session_id&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Get the subscribers of the specified queue. Specifying a cascade value
allows you to retrieve downstream subscribers as well.</p>
</dd></dl>

</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="data_model.html">Data Model</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="entities/entities.html">Entity Reference</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, Usergrid &amp; Ed Anuff.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>